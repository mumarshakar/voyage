{% comment %}
  sections/booking-calendar.liquid
  A custom section to display a booking calendar with event images.
  Supports multiple months with interactive navigation.
  Admin: Uses date picker fields in theme customizer
  Frontend: Interactive calendar with month navigation
{% endcomment %}

{%- liquid
  assign section_bg_color = section.settings.background_color | default: '#F8F7F5'
  assign padding_top = section.settings.padding_top | default: 60
  assign padding_bottom = section.settings.padding_bottom | default: 60
  assign padding_horizontal = section.settings.padding_horizontal | default: 20
  assign margin_top = section.settings.margin_top | default: 0
  assign margin_bottom = section.settings.margin_bottom | default: 0
  assign heading_color = section.settings.heading_color | default: '#8B6F47'
  assign weekday_color = section.settings.weekday_color | default: '#8B6F47'
  assign day_number_color = section.settings.day_number_color | default: '#333333'
  assign heading_font_family = section.settings.heading_font_family | default: 'Playfair Display, serif'
  assign weekday_font_family = section.settings.weekday_font_family | default: 'Playfair Display, serif'
  assign months_gap = section.settings.months_gap | default: 60
  assign show_navigation = section.settings.show_navigation | default: true
-%}

<div class="booking-calendar-section"
     id="booking-calendar-{{ section.id }}"
     style="background-color: {{ section_bg_color }};
            padding-top: {{ padding_top }}px;
            padding-bottom: {{ padding_bottom }}px;
            padding-left: {{ padding_horizontal }}px;
            padding-right: {{ padding_horizontal }}px;
            margin-top: {{ margin_top }}px;
            margin-bottom: {{ margin_bottom }}px;">

  {% comment %} Collect all month blocks and parse dates {% endcomment %}
  {% assign month_blocks = section.blocks | where: 'type', 'month' %}
  
  {% if month_blocks.size > 0 %}
    {% for month_block in month_blocks %}
      {%- liquid
        assign month_date_string = month_block.settings.month_date | default: ''
        if month_date_string != blank
          assign month_date_parts = month_date_string | split: '-'
          assign year_number = month_date_parts[0] | plus: 0
          assign month_number = month_date_parts[1] | plus: 0
        else
          assign month_number = 11
          assign year_number = 2025
        endif
      -%}
      
      <div class="calendar-month-container" 
           data-month="{{ month_number }}" 
           data-year="{{ year_number }}"
           data-block-id="{{ month_block.id }}"
           data-initial-month="{{ month_number }}"
           data-initial-year="{{ year_number }}"
           style="margin-bottom: {{ months_gap }}px;">
        
        <div class="calendar-header">
          {% if show_navigation %}
            <button class="calendar-nav-arrow calendar-nav-prev" 
                    aria-label="Previous Month"
                    style="color: {{ heading_color }};"
                    type="button">
              {% render 'icon-arrow-left' %}
            </button>
          {% endif %}
          
          <div class="calendar-month-year-selector" style="flex: 1; display: flex; justify-content: center; align-items: center; gap: 10px;">
            <select class="calendar-month-select" 
                    style="color: {{ heading_color }}; font-family: {{ heading_font_family }}; font-size: 1.5rem; font-weight: 600; border: none; background: transparent; cursor: pointer; padding: 5px;">
              <option value="1" {% if month_number == 1 %}selected{% endif %}>January</option>
              <option value="2" {% if month_number == 2 %}selected{% endif %}>February</option>
              <option value="3" {% if month_number == 3 %}selected{% endif %}>March</option>
              <option value="4" {% if month_number == 4 %}selected{% endif %}>April</option>
              <option value="5" {% if month_number == 5 %}selected{% endif %}>May</option>
              <option value="6" {% if month_number == 6 %}selected{% endif %}>June</option>
              <option value="7" {% if month_number == 7 %}selected{% endif %}>July</option>
              <option value="8" {% if month_number == 8 %}selected{% endif %}>August</option>
              <option value="9" {% if month_number == 9 %}selected{% endif %}>September</option>
              <option value="10" {% if month_number == 10 %}selected{% endif %}>October</option>
              <option value="11" {% if month_number == 11 %}selected{% endif %}>November</option>
              <option value="12" {% if month_number == 12 %}selected{% endif %}>December</option>
            </select>
            <select class="calendar-year-select" 
                    style="color: {{ heading_color }}; font-family: {{ heading_font_family }}; font-size: 1.5rem; font-weight: 600; border: none; background: transparent; cursor: pointer; padding: 5px;">
              {%- liquid
                assign current_year = 'now' | date: '%Y' | plus: 0
                assign min_year = current_year | minus: 1
                assign max_year = current_year | plus: 2
              -%}
              {% for y in (min_year..max_year) %}
                <option value="{{ y }}" {% if year_number == y %}selected{% endif %}>{{ y }}</option>
              {% endfor %}
            </select>
          </div>
          
          {% if show_navigation %}
            <button class="calendar-nav-arrow calendar-nav-next" 
                    aria-label="Next Month"
                    style="color: {{ heading_color }};"
                    type="button">
              {% render 'icon-arrow-right' %}
            </button>
          {% endif %}
        </div>

        <div class="calendar-weekdays" 
             style="color: {{ weekday_color }}; 
                    font-family: {{ weekday_font_family }};">
          <span>SU</span>
          <span>MO</span>
          <span>TU</span>
          <span>WE</span>
          <span>TH</span>
          <span>FR</span>
          <span>SA</span>
        </div>

        <div class="calendar-grid" 
             data-month="{{ month_number }}" 
             data-year="{{ year_number }}"
             data-block-id="{{ month_block.id }}">
          {% comment %} Calendar days will be populated by JavaScript {% endcomment %}
        </div>
      </div>
    {% endfor %}
  {% else %}
    {% comment %} Fallback: Show current month if no months are configured {% endcomment %}
    {%- liquid
      assign current_month = 'now' | date: '%m'
      assign current_year = 'now' | date: '%Y'
      assign current_month_num = current_month | plus: 0
      assign current_year_num = current_year | plus: 0
    -%}
    <div class="calendar-month-container" 
         data-month="{{ current_month_num }}" 
         data-year="{{ current_year_num }}"
         data-initial-month="{{ current_month_num }}"
         data-initial-year="{{ current_year_num }}"
         style="margin-bottom: {{ months_gap }}px;">
      
      <div class="calendar-header">
        {% if show_navigation %}
          <button class="calendar-nav-arrow calendar-nav-prev" 
                  aria-label="Previous Month"
                  style="color: {{ heading_color }};"
                  type="button">
            {% render 'icon-arrow-left' %}
          </button>
        {% endif %}
        
        <div class="calendar-month-year-selector" style="flex: 1; display: flex; justify-content: center; align-items: center; gap: 10px;">
          <select class="calendar-month-select" 
                  style="color: {{ heading_color }}; font-family: {{ heading_font_family }}; font-size: 1.5rem; font-weight: 600; border: none; background: transparent; cursor: pointer; padding: 5px;">
            <option value="1" {% if current_month_num == 1 %}selected{% endif %}>January</option>
            <option value="2" {% if current_month_num == 2 %}selected{% endif %}>February</option>
            <option value="3" {% if current_month_num == 3 %}selected{% endif %}>March</option>
            <option value="4" {% if current_month_num == 4 %}selected{% endif %}>April</option>
            <option value="5" {% if current_month_num == 5 %}selected{% endif %}>May</option>
            <option value="6" {% if current_month_num == 6 %}selected{% endif %}>June</option>
            <option value="7" {% if current_month_num == 7 %}selected{% endif %}>July</option>
            <option value="8" {% if current_month_num == 8 %}selected{% endif %}>August</option>
            <option value="9" {% if current_month_num == 9 %}selected{% endif %}>September</option>
            <option value="10" {% if current_month_num == 10 %}selected{% endif %}>October</option>
            <option value="11" {% if current_month_num == 11 %}selected{% endif %}>November</option>
            <option value="12" {% if current_month_num == 12 %}selected{% endif %}>December</option>
          </select>
          <select class="calendar-year-select" 
                  style="color: {{ heading_color }}; font-family: {{ heading_font_family }}; font-size: 1.5rem; font-weight: 600; border: none; background: transparent; cursor: pointer; padding: 5px;">
            {%- liquid
              assign current_year_for_select = 'now' | date: '%Y' | plus: 0
              assign min_year_fallback = current_year_for_select | minus: 1
              assign max_year_fallback = current_year_for_select | plus: 2
            -%}
            {% for y in (min_year_fallback..max_year_fallback) %}
              <option value="{{ y }}" {% if current_year_num == y %}selected{% endif %}>{{ y }}</option>
            {% endfor %}
          </select>
        </div>
        
        {% if show_navigation %}
          <button class="calendar-nav-arrow calendar-nav-next" 
                  aria-label="Next Month"
                  style="color: {{ heading_color }};"
                  type="button">
            {% render 'icon-arrow-right' %}
          </button>
        {% endif %}
      </div>

      <div class="calendar-weekdays" 
           style="color: {{ weekday_color }}; 
                  font-family: {{ weekday_font_family }};">
        <span>SU</span>
        <span>MO</span>
        <span>TU</span>
        <span>WE</span>
        <span>TH</span>
        <span>FR</span>
        <span>SA</span>
      </div>

      <div class="calendar-grid" 
           data-month="{{ current_month_num }}" 
           data-year="{{ current_year_num }}">
        {% comment %} Calendar days will be populated by JavaScript {% endcomment %}
      </div>
    </div>
  {% endif %}

  {% comment %} Event blocks - parse event dates from date picker {% endcomment %}
  {% for block in section.blocks %}
    {% if block.type == 'event' %}
      {%- liquid
        assign event_date_string = block.settings.event_date | default: ''
        if event_date_string != blank
          assign event_date_parts = event_date_string | split: '-'
          assign event_year = event_date_parts[0] | plus: 0
          assign event_month = event_date_parts[1] | plus: 0
          assign event_day = event_date_parts[2] | plus: 0
        else
          assign event_year = 2025
          assign event_month = 11
          assign event_day = 1
        endif
      -%}
      <div class="event-data" 
           data-event-month="{{ event_month }}"
           data-event-year="{{ event_year }}"
           data-event-day="{{ event_day }}"
           data-event-image="{% if block.settings.event_image != blank %}{{ block.settings.event_image | image_url: width: 400 }}{% endif %}"
           data-event-title="{{ block.settings.event_title | escape }}"
           data-event-link="{{ block.settings.event_link }}"
           style="display: none;">
      </div>
    {% endif %}
  {% endfor %}

</div>

<script>
  (function() {
    const sectionId = '{{ section.id }}';
    const calendarSection = document.getElementById('booking-calendar-{{ section.id }}');
    if (!calendarSection) return;

    // Collect all event data by month-year-day key
    const eventData = {};
    const eventDivs = calendarSection.querySelectorAll('.event-data');
    eventDivs.forEach(div => {
      const month = parseInt(div.dataset.eventMonth) || 1;
      const year = parseInt(div.dataset.eventYear) || 2025;
      const day = parseInt(div.dataset.eventDay);
      if (day && div.dataset.eventImage) {
        const key = `${year}-${month}-${day}`;
        eventData[key] = {
          image: div.dataset.eventImage,
          title: div.dataset.eventTitle || 'Event',
          link: div.dataset.eventLink || ''
        };
      }
    });

    // Month names for display
    const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                       'July', 'August', 'September', 'October', 'November', 'December'];

    // Render calendar for a specific month container
    function renderCalendar(monthContainer) {
      const calendarGrid = monthContainer.querySelector('.calendar-grid');
      const monthSelect = monthContainer.querySelector('.calendar-month-select');
      const yearSelect = monthContainer.querySelector('.calendar-year-select');
      if (!calendarGrid) return;

      let month = parseInt(monthContainer.dataset.month) || 1;
      let year = parseInt(monthContainer.dataset.year) || 2025;

      // Update data attributes
      monthContainer.dataset.month = month;
      monthContainer.dataset.year = year;

      // Update month/year selects
      if (monthSelect) {
        monthSelect.value = month;
      }
      if (yearSelect) {
        yearSelect.value = year;
      }

      // Clear existing days
      calendarGrid.innerHTML = '';

      // Calculate first day of month and days in month
      const firstDayOfMonth = new Date(year, month - 1, 1);
      const lastDayOfMonth = new Date(year, month, 0);
      const daysInMonth = lastDayOfMonth.getDate();
      const startDayOfWeek = firstDayOfMonth.getDay(); // 0 = Sunday, 1 = Monday, etc.

      // Add empty leading days
      for (let i = 0; i < startDayOfWeek; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.classList.add('calendar-day', 'empty');
        calendarGrid.appendChild(emptyDay);
      }

      // Add actual days
      for (let day = 1; day <= daysInMonth; day++) {
        const dayElement = document.createElement('div');
        dayElement.classList.add('calendar-day');
        dayElement.dataset.day = day;
        dayElement.dataset.month = month;
        dayElement.dataset.year = year;
        
        const dayNumber = document.createElement('span');
        dayNumber.classList.add('day-number');
        dayNumber.style.color = '{{ day_number_color }}';
        dayNumber.textContent = day;
        dayElement.appendChild(dayNumber);

        // Check if this day has an event
        const eventKey = `${year}-${month}-${day}`;
        if (eventData[eventKey]) {
          dayElement.classList.add('has-event');
          const eventInfo = eventData[eventKey];
          
          const imgWrapper = document.createElement('div');
          imgWrapper.classList.add('event-image-wrapper');
          const img = document.createElement('img');
          img.src = eventInfo.image;
          img.alt = eventInfo.title || 'Event';
          img.loading = 'lazy';
          img.width = '400';
          img.height = '300';
          imgWrapper.appendChild(img);
          dayElement.appendChild(imgWrapper);

          // Add click handler for events
          if (eventInfo.link) {
            dayElement.style.cursor = 'pointer';
            dayElement.addEventListener('click', function(e) {
              e.preventDefault();
              window.location.href = eventInfo.link;
            });
          } else {
            dayElement.style.cursor = 'pointer';
            dayElement.addEventListener('click', function(e) {
              e.preventDefault();
              // Show event details or trigger booking
              if (eventInfo.title) {
                alert('Event: ' + eventInfo.title + '\nDate: ' + monthNames[month - 1] + ' ' + day + ', ' + year);
              }
            });
          }
        } else {
          // Make all days clickable for booking
          dayElement.style.cursor = 'pointer';
          dayElement.addEventListener('click', function(e) {
            e.preventDefault();
            const dateStr = monthNames[month - 1] + ' ' + day + ', ' + year;
            // Trigger booking or show date picker
            console.log('Date selected: ' + dateStr);
          });
        }

        calendarGrid.appendChild(dayElement);
      }

      // Fill remaining empty cells to complete grid
      const totalCells = Math.ceil((startDayOfWeek + daysInMonth) / 7) * 7;
      const remainingCells = totalCells - (startDayOfWeek + daysInMonth);
      for (let i = 0; i < remainingCells; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.classList.add('calendar-day', 'empty');
        calendarGrid.appendChild(emptyDay);
      }
    }

    // Add navigation handlers for each calendar
    const monthContainers = calendarSection.querySelectorAll('.calendar-month-container');
    monthContainers.forEach(container => {
      const prevBtn = container.querySelector('.calendar-nav-prev');
      const nextBtn = container.querySelector('.calendar-nav-next');
      const monthSelect = container.querySelector('.calendar-month-select');
      const yearSelect = container.querySelector('.calendar-year-select');
      
      // Previous month button
      if (prevBtn) {
        prevBtn.addEventListener('click', function() {
          let month = parseInt(container.dataset.month) || 1;
          let year = parseInt(container.dataset.year) || 2025;
          
          month--;
          if (month < 1) {
            month = 12;
            year--;
          }
          
          container.dataset.month = month;
          container.dataset.year = year;
          renderCalendar(container);
        });
      }
      
      // Next month button
      if (nextBtn) {
        nextBtn.addEventListener('click', function() {
          let month = parseInt(container.dataset.month) || 1;
          let year = parseInt(container.dataset.year) || 2025;
          
          month++;
          if (month > 12) {
            month = 1;
            year++;
          }
          
          container.dataset.month = month;
          container.dataset.year = year;
          renderCalendar(container);
        });
      }
      
      // Month dropdown
      if (monthSelect) {
        monthSelect.addEventListener('change', function() {
          const month = parseInt(this.value);
          container.dataset.month = month;
          renderCalendar(container);
        });
      }
      
      // Year dropdown - populate with more years if needed
      if (yearSelect) {
        const currentYear = new Date().getFullYear();
        const selectedYear = parseInt(yearSelect.value);
        const minYear = currentYear - 1;
        const maxYear = currentYear + 3;
        
        // Check if we need to add more years
        const existingYears = Array.from(yearSelect.options).map(opt => parseInt(opt.value));
        const needsMoreYears = selectedYear < minYear || selectedYear > maxYear;
        
        if (needsMoreYears) {
          // Clear and repopulate with wider range
          yearSelect.innerHTML = '';
          const startYear = Math.min(selectedYear, minYear) - 1;
          const endYear = Math.max(selectedYear, maxYear) + 1;
          for (let y = startYear; y <= endYear; y++) {
            const option = document.createElement('option');
            option.value = y;
            option.textContent = y;
            if (y === selectedYear) option.selected = true;
            yearSelect.appendChild(option);
          }
        }
        
        yearSelect.addEventListener('change', function() {
          const year = parseInt(this.value);
          container.dataset.year = year;
          renderCalendar(container);
        });
      }
      
      // Initial render
      renderCalendar(container);
    });
  })();
</script>

<style>
  .calendar-month-container {
    margin-bottom: 60px;
  }

  .calendar-month-container:last-child {
    margin-bottom: 0;
  }

  .calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    gap: 20px;
  }

  .calendar-month-year-selector {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
  }

  .calendar-month-select,
  .calendar-year-select {
    font-size: 1.5rem;
    font-weight: 600;
    border: none;
    background: transparent;
    cursor: pointer;
    padding: 5px;
    outline: none;
  }

  .calendar-month-select:hover,
  .calendar-year-select:hover {
    opacity: 0.8;
  }

  .calendar-month-select:focus,
  .calendar-year-select:focus {
    outline: 2px solid currentColor;
    outline-offset: 2px;
    border-radius: 2px;
  }

  .calendar-nav-arrow {
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.3s ease, transform 0.2s ease;
    font-size: 1.5rem;
    min-width: 44px;
    min-height: 44px;
  }

  .calendar-nav-arrow:hover {
    opacity: 0.7;
    transform: scale(1.1);
  }

  .calendar-nav-arrow:active {
    transform: scale(0.95);
  }

  .calendar-nav-arrow svg {
    width: 24px;
    height: 24px;
  }

  .calendar-day {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .calendar-day:not(.empty):hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  @media (max-width: 768px) {
    .calendar-month-select,
    .calendar-year-select {
      font-size: 1.2rem;
    }
    
    .calendar-month-container {
      margin-bottom: 40px;
    }

    .calendar-nav-arrow {
      padding: 6px 8px;
      min-width: 36px;
      min-height: 36px;
    }

    .calendar-nav-arrow svg {
      width: 20px;
      height: 20px;
    }

    .calendar-month-year-selector {
      flex-direction: column;
      gap: 5px;
    }
  }
</style>

{% schema %}
{
  "name": "Booking Calendar",
  "tag": "section",
  "class": "section-booking-calendar",
  "settings": [
    {
      "type": "header",
      "content": "Section Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Top",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 200,
      "step": 5,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_horizontal",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Padding Horizontal",
      "default": 20
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Margin Top",
      "default": 0
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px",
      "label": "Margin Bottom",
      "default": 0
    },
    {
      "type": "range",
      "id": "months_gap",
      "min": 20,
      "max": 100,
      "step": 10,
      "unit": "px",
      "label": "Gap Between Months",
      "default": 60,
      "info": "Spacing between multiple month calendars"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#F8F7F5"
    },
    {
      "type": "header",
      "content": "Calendar Navigation"
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "label": "Show Month Navigation",
      "default": true,
      "info": "Display previous/next month buttons"
    },
    {
      "type": "header",
      "content": "Calendar Styling"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#8B6F47"
    },
    {
      "type": "select",
      "id": "heading_font_family",
      "label": "Heading Font Family",
      "options": [
        {
          "value": "Playfair Display, serif",
          "label": "Playfair Display"
        },
        {
          "value": "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
          "label": "Segoe UI"
        },
        {
          "value": "Arial, sans-serif",
          "label": "Arial"
        }
      ],
      "default": "Playfair Display, serif"
    },
    {
      "type": "header",
      "content": "Weekdays"
    },
    {
      "type": "color",
      "id": "weekday_color",
      "label": "Weekday Text Color",
      "default": "#8B6F47"
    },
    {
      "type": "select",
      "id": "weekday_font_family",
      "label": "Weekday Font Family",
      "options": [
        {
          "value": "Playfair Display, serif",
          "label": "Playfair Display"
        },
        {
          "value": "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
          "label": "Segoe UI"
        },
        {
          "value": "Arial, sans-serif",
          "label": "Arial"
        }
      ],
      "default": "Playfair Display, serif"
    },
    {
      "type": "header",
      "content": "Day Numbers"
    },
    {
      "type": "color",
      "id": "day_number_color",
      "label": "Day Number Color",
      "default": "#333333"
    }
  ],
  "blocks": [
    {
      "type": "month",
      "name": "Month",
      "settings": [
        {
          "type": "text",
          "id": "month_date",
          "label": "Month Date",
          "default": "2025-11-01",
          "info": "Select the month to display. Format: YYYY-MM-DD (e.g., 2025-11-01). Click in this field and most browsers will show a calendar date picker. The day can be any day in that month - only the month and year are used."
        }
      ]
    },
    {
      "type": "event",
      "name": "Event",
      "settings": [
        {
          "type": "text",
          "id": "event_date",
          "label": "Event Date",
          "default": "2025-11-01",
          "info": "Select the exact date for this event. Format: YYYY-MM-DD (e.g., 2025-11-15). Click in this field and most browsers will show a calendar date picker to select the date visually."
        },
        {
          "type": "image_picker",
          "id": "event_image",
          "label": "Event Image",
          "info": "Image to display on this day"
        },
        {
          "type": "text",
          "id": "event_title",
          "label": "Event Title",
          "default": "Yoga Class",
          "info": "Title or description of the event"
        },
        {
          "type": "url",
          "id": "event_link",
          "label": "Event Link",
          "info": "Optional: Link when clicking on the event day"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Booking Calendar",
      "blocks": [
        {
          "type": "month",
          "settings": {
            "month_date": "2025-11-01"
          }
        },
        {
          "type": "month",
          "settings": {
            "month_date": "2025-12-01"
          }
        },
        {
          "type": "event",
          "settings": {
            "event_date": "2025-11-01",
            "event_title": "Yoga Class"
          }
        },
        {
          "type": "event",
          "settings": {
            "event_date": "2025-11-05",
            "event_title": "Pilates Session"
          }
        },
        {
          "type": "event",
          "settings": {
            "event_date": "2025-12-15",
            "event_title": "Yoga Class"
          }
        }
      ]
    }
  ]
}
{% endschema %}
